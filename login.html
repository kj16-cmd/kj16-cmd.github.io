<!DOCTYPE html>
<html>

  <link rel="stylesheet" href="../styles/beef.css">
<body>
  <!-- Applying .header class to a header element -->
  <div class="header">
    <h1>Welcome Employees to titan Inc.</h1>
  </div>
  <!-- Container div with the 'center-both' class -->
  <div class="center-both">
    <!-- Content to center inside the 'center-text' div -->
    <div class="center-text">
      <h1>Welcome Employees to Titan Inc.</h1>
<p>Please Login in with your Username and Password<br>
	initial.lastname username format </p>

<form> 
<label for="Username">Username:</label><br>
<input type="text" id="Username" name="Username"><br>
<label for="Password">Password:</label><br>
<input type="text" id="Password" name="Password"><br><br>

<input type="button" id="confirm" name="confirm" onclick="auth_user()">
<label for="confirm">Confirm</label>

</form>
<button id="prevPage" onclick="prevPage()">Previous</button>
<button id="nextPage" onclick="nextPage()">Next</button>
<p><a href="db_analyst.html">database engineering</a></p> 
<p><a href="sec_analyst.html">security analyst</a></p> 



<script>
 let currentPage = 1; // Keep track of the current page
 const entriesPerPage = 10; // Define how many entries to display at a time
 function auth_user() {
  const Username = document.getElementById("Username").value.trim().toLowerCase();
  const Password = document.getElementById("Password").value.trim();
  
  fetch('db/db.json')
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
      return response.json(); // Automatically parse the response as JSON
    })
    .then(data => {
      let found = false;  // Variable to track if a match is found
      let userstatus = "";
      const totalEntries = data.length; // Total number of entries in the JSON file

      // Calculate start and end indices based on currentPage and entriesPerPage
      const startIndex = (currentPage - 1) * entriesPerPage;
      const endIndex = startIndex + entriesPerPage;
      
      // Slice the data array to only get the entries for the current page
      const pageData = data.slice(startIndex, endIndex);

      // Loop through the pageData array
      for (let i = 0; i < pageData.length; i++) {
        // Check if both the username and password match
        if (pageData[i].Username.toLowerCase() === Username && pageData[i].Password === Password) {
          found = true;  // Set found to true if a match is found
          userstatus = pageData[i].role;
          break;  // Exit the loop once a match is found
        }
      }

      // After the loop, check if a match was found
      if (found) {
        console.log("Login successful!");

        // Check the user role and redirect accordingly
        if (userstatus === 'lawyer') {
          window.location.href = "lawyer.html"; // Redirect to lawyer page
        } else if (userstatus === 'db_analyst') {
          window.location.href = "db_analyst.html"; // Redirect to db_analyst page
        } else if (userstatus === 'customer_support') {
          window.location.href = "customer_support.html"; // Redirect to customer_support page
        } else if (userstatus === 'accountant') {
          window.location.href = "accountant.html"; // Redirect to accountant page
        } else if (userstatus === 'public_relations') {
          window.location.href = "public_relations.html"; // Redirect to public_relations page
        } else if (userstatus === 'recruiter') {
          window.location.href = "recruiter.html"; // Redirect to recruiter page
        } else if (userstatus === 'sales') {
          window.location.href = "sales.html"; // Redirect to sales page
        } else if (userstatus === 'sec_analyst') {
          window.location.href = "sec_analyst.html"; // Redirect to sec_analyst page
        } else if (userstatus === 'janitor') {
          window.location.href = "janitor.html"; // Redirect to janitor page
        } else {
          alert("User role not recognized, no valid redirect available.");
        }
      } else {
        console.log("Invalid username or password");
        alert("Invalid username or password");
      }

      // Add navigation buttons (next and previous) if there are more pages
      updatePaginationButtons(currentPage, totalEntries);
    })
    .catch(error => {
      console.error("Error fetching or parsing JSON:", error);
      alert("Error fetching data");
    });
}

// Function to update the pagination buttons
function updatePaginationButtons(currentPage, totalEntries) {
  const totalPages = Math.ceil(totalEntries / entriesPerPage);

  // Disable the "Previous" button if we're on the first page
  const prevButton = document.getElementById('prevPage');
  if (currentPage === 1) {
    prevButton.disabled = true;
  } else {
    prevButton.disabled = false;
  }

  // Disable the "Next" button if we're on the last page
  const nextButton = document.getElementById('nextPage');
  if (currentPage === totalPages) {
    nextButton.disabled = true;
  } else {
    nextButton.disabled = false;
  }
}

// Function to navigate to the next page
function nextPage() {
  currentPage++;
  auth_user(); // Re-fetch the data for the new page
}

// Function to navigate to the previous page
function prevPage() {
  currentPage--;
  auth_user(); // Re-fetch the data for the new page
}
</script>
</body>
</html> 
